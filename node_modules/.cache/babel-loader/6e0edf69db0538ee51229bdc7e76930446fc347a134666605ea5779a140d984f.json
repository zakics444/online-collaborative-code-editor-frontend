{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Editor}from'@monaco-editor/react';import socket from'../services/socket';import axios from'../services/axios';import Chat from'./Chat';import{useLocation}from'react-router-dom';// Import useLocation to get data passed from Project.js\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CodeEditor=()=>{const location=useLocation();// Get data passed when navigating\nconst{projectName,pjpassword}=location.state||{};// Extract project name and password from state\nconst[code,setCode]=useState('');// Store the project code\nconst[language,setLanguage]=useState('javascript');// Default language for the editor\nconst[isSaved,setIsSaved]=useState(false);// Track whether code is saved\n// Fetch the project code on mount using project name and password\nuseEffect(()=>{if(!projectName||!pjpassword){alert('Project name or password is missing.');return;}const fetchProjectCode=async()=>{try{const response=await axios.get(`/api/projects/${projectName}/${pjpassword}`);if(response.data.code){setCode(response.data.code);// Set the project code if available\n}else{console.error('No code found for the project.');}}catch(error){console.error('Failed to fetch project code:',error.message);}};fetchProjectCode();},[projectName,pjpassword]);// Listen for real-time code updates from other users\nuseEffect(()=>{socket.on('receiveCode',codeData=>{setCode(codeData.code);// Update code when other users make changes\n});return()=>{socket.off('receiveCode');};},[]);// Emit real-time code changes to the backend\nconst handleCodeChange=newCode=>{setCode(newCode);socket.emit('codeChange',{code:newCode,projectName,pjpassword});};// Save code to the project\nconst saveCode=async()=>{if(!projectName||!pjpassword){alert('Project name or password is missing.');return;}try{await axios.post(`/projects/saveCode`,{projectName,pjpassword,code});setIsSaved(true);alert('Code saved successfully');}catch(error){console.error('Error saving code:',error.message);alert('Failed to save code');}};// Unsave code and revert to the original code\nconst unsaveCode=async()=>{if(!projectName||!pjpassword){alert('Project name or password is missing.');return;}try{await axios.post(`/projects/unsaveCode`,{projectName,pjpassword});setIsSaved(false);alert('Code reverted to original');}catch(error){console.error('Error reverting code:',error.message);alert('Failed to revert code');}};return/*#__PURE__*/_jsx(\"div\",{className:\"editor-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"editor-and-chat\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(Editor,{height:\"80vh\",defaultLanguage:language,value:code,theme:\"vs-dark\",onChange:handleCodeChange,options:{fontSize:14,automaticLayout:true}}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:saveCode,disabled:isSaved,style:{padding:'10px',marginRight:'10px'},children:\"Save Code\"}),/*#__PURE__*/_jsx(\"button\",{onClick:unsaveCode,disabled:!isSaved,style:{padding:'10px'},children:\"Unsave Code\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:0.4,marginTop:'20px'},children:[/*#__PURE__*/_jsx(Chat,{}),\"  \"]})]})});};export default CodeEditor;","map":{"version":3,"names":["React","useState","useEffect","Editor","socket","axios","Chat","useLocation","jsx","_jsx","jsxs","_jsxs","CodeEditor","location","projectName","pjpassword","state","code","setCode","language","setLanguage","isSaved","setIsSaved","alert","fetchProjectCode","response","get","data","console","error","message","on","codeData","off","handleCodeChange","newCode","emit","saveCode","post","unsaveCode","className","children","style","flex","height","defaultLanguage","value","theme","onChange","options","fontSize","automaticLayout","marginTop","onClick","disabled","padding","marginRight"],"sources":["C:/project final/frontend/src/components/Editor.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Editor } from '@monaco-editor/react';\r\nimport socket from '../services/socket';\r\nimport axios from '../services/axios';\r\nimport Chat from './Chat';\r\nimport { useLocation } from 'react-router-dom';  // Import useLocation to get data passed from Project.js\r\n\r\nconst CodeEditor = () => {\r\n    const location = useLocation();  // Get data passed when navigating\r\n    const { projectName, pjpassword } = location.state || {};  // Extract project name and password from state\r\n\r\n    const [code, setCode] = useState('');  // Store the project code\r\n    const [language, setLanguage] = useState('javascript');  // Default language for the editor\r\n    const [isSaved, setIsSaved] = useState(false);  // Track whether code is saved\r\n\r\n    // Fetch the project code on mount using project name and password\r\n    useEffect(() => {\r\n        if (!projectName || !pjpassword) {\r\n            alert('Project name or password is missing.');\r\n            return;\r\n        }\r\n\r\n        const fetchProjectCode = async () => {\r\n            try {\r\n                const response = await axios.get(`/api/projects/${projectName}/${pjpassword}`);\r\n                if (response.data.code) {\r\n                    setCode(response.data.code);  // Set the project code if available\r\n                } else {\r\n                    console.error('No code found for the project.');\r\n                }\r\n            } catch (error) {\r\n                console.error('Failed to fetch project code:', error.message);\r\n            }\r\n        };\r\n\r\n        fetchProjectCode();\r\n    }, [projectName, pjpassword]);\r\n\r\n    // Listen for real-time code updates from other users\r\n    useEffect(() => {\r\n        socket.on('receiveCode', (codeData) => {\r\n            setCode(codeData.code);  // Update code when other users make changes\r\n        });\r\n\r\n        return () => {\r\n            socket.off('receiveCode');\r\n        };\r\n    }, []);\r\n\r\n    // Emit real-time code changes to the backend\r\n    const handleCodeChange = (newCode) => {\r\n        setCode(newCode);\r\n        socket.emit('codeChange', { code: newCode, projectName, pjpassword });\r\n    };\r\n\r\n    // Save code to the project\r\n    const saveCode = async () => {\r\n        if (!projectName || !pjpassword) {\r\n            alert('Project name or password is missing.');\r\n            return;\r\n        }\r\n        try {\r\n            await axios.post(`/projects/saveCode`, { projectName, pjpassword, code });\r\n            setIsSaved(true);\r\n            alert('Code saved successfully');\r\n        } catch (error) {\r\n            console.error('Error saving code:', error.message);\r\n            alert('Failed to save code');\r\n        }\r\n    };\r\n\r\n    // Unsave code and revert to the original code\r\n    const unsaveCode = async () => {\r\n        if (!projectName || !pjpassword) {\r\n            alert('Project name or password is missing.');\r\n            return;\r\n        }\r\n        try {\r\n            await axios.post(`/projects/unsaveCode`, { projectName, pjpassword });\r\n            setIsSaved(false);\r\n            alert('Code reverted to original');\r\n        } catch (error) {\r\n            console.error('Error reverting code:', error.message);\r\n            alert('Failed to revert code');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"editor-container\">\r\n            <div className=\"editor-and-chat\">\r\n                <div style={{ flex: 1 }}>\r\n                    <Editor\r\n                        height=\"80vh\"\r\n                        defaultLanguage={language}\r\n                        value={code}\r\n                        theme=\"vs-dark\"\r\n                        onChange={handleCodeChange}\r\n                        options={{\r\n                            fontSize: 14,\r\n                            automaticLayout: true,\r\n                        }}\r\n                    />\r\n                    <div style={{ marginTop: '10px' }}>\r\n                        <button onClick={saveCode} disabled={isSaved} style={{ padding: '10px', marginRight: '10px' }}>\r\n                            Save Code\r\n                        </button>\r\n                        <button onClick={unsaveCode} disabled={!isSaved} style={{ padding: '10px' }}>\r\n                            Unsave Code\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div style={{ flex: 0.4, marginTop: '20px' }}>\r\n                    <Chat />  {/* Display the chat component */}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CodeEditor;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}